---
import ProductCard from "./ProductCard.astro";

interface Product {
  id: number;
  name: string;
  slug: string;
  price: string;
  discount_price?: string;
  gallery?: string[];
  in_stock: boolean;
  stock_quantity: number;
  attributes?: Record<string, string>;
}

let products: Product[] = [];

try {
  const response = await fetch("https://admin.bablon.in/public/api/products");
  const allProducts = await response.json();
  products = allProducts.slice(0, 7); // Limit to 7
} catch (error) {
  console.error("Error fetching products:", error);
}
---

<div class="max-w-7xl mx-auto px-4 py-16 flex flex-col md:flex-row">
  <!-- Title Section -->

  <!-- Products Grid -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
    <div class="md:w-1/4 mb-8 md:mb-0 pr-0 md:pr-8">
      <h2 class="text-4xl font-bold mb-2">
        <span class="block">Best</span>
        <span class="block">Modern</span>
        <span class="block">Furniture</span>
      </h2>
      <a href="/shop" class="inline-block mt-4 text-sm font-medium">
        See All &gt;&gt;
      </a>
    </div>

    {
      products.map((product: Product) => {
        if (!product) return null;

        return <ProductCard product={product} />;
      })
    }
  </div>
</div>

